#! /usr/bin/env python2

"""Example post-receive hook based on git_multimail.

It is possible to use git_multimail.py itself as a post-receive or
update hook, configured via git config settings and/or command-line
parameters.  But for more flexibility, it can also be imported as a
Python module by a custom post-receive script.  This has the following
advantages:

* The tool's behavior can be customized using arbitrary Python code,
  without having to edit git_multimail.py.

* Configuration settings can be read from other sources; for example,
  user names and email addresses can be read from LDAP or from a
  database.  Or the settings can even be hardcoded in the importing
  Python script, if this is preferred.

This script is a simple example of a post-receive hook implemented
using git_multimail as a Python module.

"""

import sys

# If necessary, add the path to the directory containing
# git_multimail.py to the Python path as follows.  (This is not
# necessary if git_multimail.py is in the same directory as this
# script):

#LIBDIR = 'path/to/directory/containing/module'
#sys.path.insert(0, LIBDIR)

import git_multimail


# It is possible to modify the output templates here; e.g.:

#git_multimail.FOOTER_TEMPLATE = """\
#
#-- \n\
#This email was generated by the wonderful git_multimail tool.
#""".splitlines(True)


# Specify which "git config" section contains the configuration for
# git-multimail:
config = git_multimail.Config('multimailhook')

# Select the type of environment:
environment = git_multimail.GenericEnvironment(config)

# Choose the method of sending emails:
mailer = git_multimail.SendMailer(environment)

# Read changes from stdin and send notification emails:
git_multimail.run_as_post_receive_hook(environment, mailer)
